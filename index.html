<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>synt — everything feels different in the dark</title>
<meta name="description" content="synt — ambient sounds and visuals. Everything feels different in the dark.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="https://example.com/">
<meta property="og:title" content="synt — everything feels different in the dark">
<meta property="og:description" content="synt — ambient sounds and visuals. Everything feels different in the dark.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://example.com/">
<meta name="twitter:card" content="summary_large_image">

<style>
:root{
  /* Colors & visual tokens */
  --bg: #0a0a0a;
  --fg: #ffffff;
  --muted: rgba(255,255,255,0.6);
  --card-bg: #111;
  --input-bg: #000;
  --input-border: #444;
  --accent: rgba(255,255,255,0.1);
  --success: #0f0;
  --error: #ff5c5c;

  /* Borders & sizes */
  --border-width: 2px;
  --border-color: var(--fg);

  /* Spacing & layout (tuned for visually balanced layout) */
  --page-padding: clamp(1rem, 3vw, 2.25rem); /* keeps content from hugging edges */
  --max-content-width: 1200px;

  /* Stage spacing: offset moves the centered block slightly downward for better visual weight */
  --stage-offset: 3.5vh;   /* primary downward offset to address "synt" being too high */

  /* Internal spacing tuned visually */
  --stage-gap: 1.05rem;    /* space between logo, byline and menu */
  --logo-byline-gap: 0.18rem;
  --byline-menu-gap: 0.6rem;

  /* Menu/button spacing */
  --menu-gap: 0.72rem;
  --menu-padding-vertical: 0.85rem;
  --menu-padding-horizontal: 1.6rem;
  --menu-min-width: 120px;

  --control-padding: 0.5rem;

  /* Typography */
  --font-family: monospace, ui-monospace, "SFMono-Regular", Menlo, Monaco, "Roboto Mono", "Segoe UI Mono", monospace;
  --byline-size: 0.95rem;

  /* Effects */
  --shadow-small: 0 0 5px #fff;
  --shadow-medium: 0 0 15px #fff;
  --shadow-large: 0 0 30px rgba(255,255,255,0.6);

  /* Flicker base */
  --flicker-brightness: 1;
}

/* Base */
html, body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  height: 100%;
  font-family: var(--font-family);
  overflow: hidden; /* keep original behavior */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Accessibility helper */
.visually-hidden {
  position: absolute !important;
  height: 1px; width: 1px;
  overflow: hidden;
  clip: rect(1px, 1px, 1px, 1px);
  white-space: nowrap;
}

/* Skip link */
.skip-link {
  position: absolute;
  left: -9999px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}
.skip-link:focus {
  left: 1rem;
  top: 1rem;
  width: auto;
  height: auto;
  padding: 0.5rem 1rem;
  background: #222;
  color: var(--fg);
  z-index: 9999;
  text-decoration: none;
  border-radius: 6px;
}

/* Film grain */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.04) 0px,
    rgba(255,255,255,0.04) 1px,
    transparent 1px,
    transparent 3px
  );
  pointer-events: none;
  z-index: 5;
  mix-blend-mode: overlay;
}

/* Main centering - keeps equal space above/below but stage is visually nudged down a little */
main#main {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--page-padding);
  position: relative;
}

/* Stage - tuned spacing & subtle downward offset to lower the visual anchor of the logo */
.stage {
  width: min(var(--max-content-width), 100%);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap: var(--stage-gap);
  position: relative;
  z-index: 10;
  opacity: 1;
  transition: opacity 0.45s ease, transform 0.45s ease;
  transform: translateY(var(--stage-offset));
}

/* Logo - preserve original large styling + tightened letter spacing */
.logo {
  font-size: clamp(4rem, 18vw, 14rem);
  font-weight: bold;
  text-transform: uppercase;
  color: var(--fg);
  filter: brightness(var(--flicker-brightness));
  text-shadow: var(--shadow-small), var(--shadow-medium), var(--shadow-large);
  transition: filter 0.1s ease, text-shadow 0.1s ease;

  /* tightened tracking so 'synt' reads dense but not cramped */
  letter-spacing: -0.05em;
  font-kerning: normal;
  text-rendering: optimizeLegibility;
  margin: 0;
}

/* Byline visually close to the logo but separated slightly for legibility */
.byline {
  font-size: var(--byline-size);
  opacity: 0.65;
  margin: 0;
  padding-top: var(--logo-byline-gap);
  letter-spacing: 0.18em;
}

/* Menu sits a little closer to byline than before but not cramped */
.menu {
  display:flex;
  gap: var(--menu-gap);
  margin-top: var(--byline-menu-gap);
  justify-content: center;
  flex-wrap: wrap;
  opacity: 0;
  transition: opacity 0.9s ease;
}

/* Buttons preserved visually but slightly constrained to avoid edge hug */
.menu-box {
  background: transparent;
  color: var(--fg);
  border: var(--border-width) solid var(--border-color);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  cursor: pointer;
  position: relative;
  overflow: hidden;
  padding: var(--menu-padding-vertical) var(--menu-padding-horizontal);
  font-family: inherit;
  font-size: inherit;
  text-align: center;
  -webkit-appearance: none;
  -moz-appearance: none;
  border-radius: 6px;
  min-width: var(--menu-min-width);
}
.menu-box::after {
  content: "";
  position: absolute;
  inset: 0;
  background: var(--accent);
  transform: translateY(100%);
  transition: transform 0.28s ease;
  pointer-events: none;
}
.menu-box:hover::after { transform: translateY(0); }
.menu-box:hover { filter: brightness(1.45); }

/* Popup Form */
.popup {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 100;
}
.popup form {
  display:flex;
  flex-direction:column;
  gap: 1rem;
  background: var(--card-bg);
  padding: 2rem;
  border: var(--border-width) solid var(--border-color);
  width: 320px;
  border-radius: 8px;
}
.popup input, .popup textarea {
  background: var(--input-bg);
  color: var(--fg);
  border: 1px solid var(--input-border);
  padding: var(--control-padding);
  font-family: var(--font-family);
  border-radius: 6px;
}
.popup button[type="submit"] {
  background: var(--fg);
  color: var(--bg);
  border: none;
  padding: 0.6rem;
  cursor: pointer;
  font-weight: bold;
  border-radius: 6px;
}
.form-status { font-size: 0.9rem; color: var(--success); }

/* Sections (unchanged behavior) */
.section {
  position: fixed;
  inset: 0;
  background: var(--bg);
  display: none;
  flex-direction: column;
  align-items: center;
  padding: 2rem;
  overflow-y: auto;
  z-index: 90;
}
.section h1 { text-transform: uppercase; margin-bottom: 2rem; }
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(200px,1fr));
  gap: 1rem;
  width: 100%;
  max-width: var(--max-content-width);
}
.track, .visual {
  background: var(--card-bg);
  padding: 1rem;
  border: var(--border-width) solid var(--border-color);
  border-radius: 6px;
}
.track audio { width:100%; }
.visual img { width:100%; height:auto; display:block; }

/* back button */
.back-btn {
  margin-top: 2rem;
  cursor: pointer;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  border: var(--border-width) solid var(--border-color);
  padding: 0.5rem 1rem;
  background: transparent;
  color: var(--fg);
  border-radius: 6px;
}
.back-btn:hover { filter: brightness(1.45); }

/* Responsive adjustments */
@media (max-width: 880px) {
  :root { --stage-offset: 3vh; --stage-gap: 0.9rem; }
  .menu-box { min-width: 100px; padding-inline: 1.25rem; }
}
@media (max-width: 520px) {
  :root { --stage-offset: 2vh; }
  .logo { font-size: clamp(2.2rem, 14vw, 6.6rem); letter-spacing: -0.03em; }
  .menu { gap: 0.45rem; margin-top: 0.45rem; }
  .menu-box { min-width: 84px; padding: 0.7rem 1rem; font-size: 0.95rem; }
  .popup form { width: 92%; max-width: 420px; padding: 1rem; }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .stage, .menu-box, .menu-box::after, body::before { transition: none !important; animation: none !important; }
}
</style>
</head>
<body>
  <a href="#main" class="skip-link">Skip to content</a>

  <main id="main">
    <header class="stage" id="stage" role="banner" aria-hidden="false">
      <h1 id="logo" class="logo" tabindex="-1">synt</h1>
      <p class="byline">everything feels different in the dark</p>

      <nav class="menu" id="menu" aria-label="Primary">
        <button class="menu-box" data-section="sounds" type="button">Sounds</button>
        <button class="menu-box" data-section="visuals" type="button">Visuals</button>
        <button class="menu-box" id="tellBtn" type="button">Tell me something</button>
      </nav>
    </header>

    <!-- Popup Form -->
    <div class="popup" id="popup" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="tell-heading">
      <form id="tellMeForm" action="https://formspree.io/f/meozvvon" method="POST" novalidate>
        <h2 id="tell-heading" class="visually-hidden">Send a message</h2>

        <label class="visually-hidden" for="name">Your name</label>
        <input id="name" type="text" name="name" placeholder="Your name" required aria-required="true">

        <label class="visually-hidden" for="message">Your message</label>
        <textarea id="message" rows="4" name="message" placeholder="Your message" required aria-required="true"></textarea>

        <button type="submit">Send</button>
        <p id="formStatus" class="form-status" role="status" aria-live="polite"></p>

        <button class="back-btn" id="closePopup" type="button">Close</button>
      </form>
    </div>

    <!-- Sounds Section -->
    <section class="section" id="sounds" role="region" aria-labelledby="sounds-heading" aria-hidden="true">
      <h1 id="sounds-heading" tabindex="-1">Sounds</h1>
      <div class="grid">
        <div class="track">
          <strong>Track 1</strong>
          <audio controls preload="none">
            <source src="your-audio.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
        <div class="track">
          <strong>Track 2</strong>
          <audio controls preload="none">
            <source src="your-audio2.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>
      </div>
      <button class="back-btn" type="button" onclick="goHome()">Back</button>
    </section>

    <!-- Visuals Section -->
    <section class="section" id="visuals" role="region" aria-labelledby="visuals-heading" aria-hidden="true">
      <h1 id="visuals-heading" tabindex="-1">Visuals</h1>
      <div class="grid">
        <div class="visual">
          <img src="everything feels different in the dark.png" alt="Album artwork: everything feels different in the dark" width="800" height="600" loading="lazy">
        </div>
        <div class="visual">
          <img src="https://placehold.co/400x300" alt="Placeholder visual" loading="lazy" width="400" height="300">
        </div>
      </div>
      <button class="back-btn" type="button" onclick="goHome()">Back</button>
    </section>
  </main>

  <!-- Ambient background audio -->
  <audio id="ambientAudio" loop preload="none">
    <source src="ambient.mp3" type="audio/mpeg">
  </audio>

  <!-- Hidden flicker sound effects -->
  <audio id="flickerSound1" preload="none">
    <source src="flicker1.mp3" type="audio/mpeg">
  </audio>
  <audio id="flickerSound2" preload="none">
    <source src="flicker2.mp3" type="audio/mpeg">
  </audio>

<script>
/* ======================
   DOM references
   ====================== */
const logo = document.getElementById('logo');
const menu = document.getElementById('menu');
const stage = document.getElementById('stage');
const popup = document.getElementById('popup');
const sections = document.querySelectorAll('.section');
const tellBtn = document.getElementById('tellBtn');
const closePopup = document.getElementById('closePopup');
const form = document.getElementById('tellMeForm');
const formStatus = document.getElementById('formStatus');

let lastFocusedElement = null;
let modalKeyHandler = null;

/* ======================
   Ambient audio fade
   ====================== */
const ambientAudio = document.getElementById('ambientAudio');
let ambientFadeInterval;
function fadeAudio(audio, targetVolume, duration) {
  clearInterval(ambientFadeInterval);
  const start = isFinite(audio.volume) ? audio.volume : 0;
  const step = (targetVolume - start) / Math.max(1, Math.floor(duration / 50));
  ambientFadeInterval = setInterval(() => {
    audio.volume = Math.min(Math.max(audio.volume + step, 0), 1);
    if ((step > 0 && audio.volume >= targetVolume) ||
        (step < 0 && audio.volume <= targetVolume)) {
      clearInterval(ambientFadeInterval);
    }
  }, 50);
}
function startAmbientOnInteraction() {
  if (ambientAudio.paused) {
    ambientAudio.volume = 0;
    ambientAudio.play().catch(err => console.warn("Autoplay blocked:", err));
    fadeAudio(ambientAudio, 0.3, 3000);
  }
  document.removeEventListener('click', startAmbientOnInteraction);
}
document.addEventListener('click', startAmbientOnInteraction, { once: true });

/* ======================
   Flicker loop (preserve original behavior)
   ====================== */
const flickerSounds = [
  document.getElementById('flickerSound1'),
  document.getElementById('flickerSound2')
];
function playFlickerSound() {
  const sound = flickerSounds[Math.floor(Math.random() * flickerSounds.length)];
  if (sound) {
    try {
      sound.currentTime = 0;
      sound.play().catch(() => {});
    } catch (e) {}
  }
}
function flickerLoop() {
  if (Math.random() < 0.1) {
    logo.style.setProperty('--flicker-brightness', 3 + Math.random()*2);
    logo.style.textShadow = "0 0 10px #fff,0 0 40px #fff,0 0 80px rgba(255,255,255,0.8)";
    playFlickerSound();
  } else {
    logo.style.setProperty('--flicker-brightness', 0.6 + Math.random()*0.3);
    logo.style.textShadow = "0 0 4px #fff,0 0 12px rgba(255,255,255,0.5)";
  }
  setTimeout(flickerLoop, 50 + Math.random()*200);
}
flickerLoop();

/* Reveal menu after a short delay */
setTimeout(() => {
  menu.style.opacity = 1;
}, 900);

/* ======================
   Section navigation (accessibility-minded)
   ====================== */
document.querySelectorAll('button.menu-box[data-section]').forEach(box => {
  box.addEventListener('click', () => {
    const sectionId = box.dataset.section;
    const section = document.getElementById(sectionId);
    if (!section) return;

    // hide stage (visual timing)
    stage.style.opacity = 0;

    // hide all sections first
    sections.forEach(s => {
      s.style.display = 'none';
      s.setAttribute('aria-hidden', 'true');
    });

    // reveal requested section after fade
    setTimeout(() => {
      section.style.display = 'flex';
      section.setAttribute('aria-hidden', 'false');
      const heading = section.querySelector('h1, h2');
      if (heading) heading.focus({preventScroll: true});
    }, 450);
  });
});

/* ======================
   Focus trap helpers for modal
   ====================== */
function getFocusableElements(container) {
  const selectors = [
    'a[href]',
    'area[href]',
    'input:not([disabled]):not([type="hidden"])',
    'select:not([disabled])',
    'textarea:not([disabled])',
    'button:not([disabled])',
    'iframe',
    'object',
    'embed',
    '[contenteditable]',
    '[tabindex]:not([tabindex="-1"])'
  ];
  return Array.from(container.querySelectorAll(selectors.join(','))).filter(el => {
    return el.offsetWidth > 0 || el.offsetHeight > 0 || el.getClientRects().length;
  });
}

function trapFocus(container) {
  const focusable = getFocusableElements(container);
  if (!focusable.length) return;

  const first = focusable[0];
  const last = focusable[focusable.length - 1];

  modalKeyHandler = function(e) {
    if (e.key === 'Tab') {
      if (e.shiftKey && document.activeElement === first) {
        e.preventDefault();
        last.focus();
      } else if (!e.shiftKey && document.activeElement === last) {
        e.preventDefault();
        first.focus();
      }
    }
  };
  document.addEventListener('keydown', modalKeyHandler);
}

function releaseFocusTrap() {
  if (modalKeyHandler) {
    document.removeEventListener('keydown', modalKeyHandler);
    modalKeyHandler = null;
  }
}

/* ======================
   Modal open/close with strict trap
   ====================== */
tellBtn.addEventListener('click', () => {
  lastFocusedElement = document.activeElement;
  popup.style.display = 'flex';
  popup.setAttribute('aria-hidden', 'false');
  document.querySelector('main').setAttribute('aria-hidden', 'true');

  const firstControl = form.querySelector('input, textarea, button');
  if (firstControl) firstControl.focus();

  trapFocus(popup);
});

closePopup.addEventListener('click', closePopupFn);

function closePopupFn() {
  popup.style.display = 'none';
  popup.setAttribute('aria-hidden', 'true');
  document.querySelector('main').setAttribute('aria-hidden', 'false');
  releaseFocusTrap();
  if (lastFocusedElement && typeof lastFocusedElement.focus === 'function') lastFocusedElement.focus();
}

/* Close modal/sections with Escape */
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    if (popup.style.display === 'flex') {
      closePopupFn();
      return;
    }
    const anyVisibleSection = Array.from(sections).some(s => s.style.display === 'flex');
    if (anyVisibleSection) goHome();
  }
});

/* ======================
   Robust form submission (JSON -> FormData -> mailto fallback)
   ====================== */
async function submitFormRobust(evt) {
  evt.preventDefault();
  formStatus.style.color = '';
  formStatus.textContent = "Sending...";
  const name = form.name.value.trim();
  const message = form.message.value.trim();

  if (!name || !message) {
    formStatus.style.color = 'var(--error)';
    formStatus.textContent = "Please fill out both fields.";
    return;
  }

  const endpoint = form.action;
  const method = (form.method || 'POST').toUpperCase();

  const payload = { name, message };
  try {
    const res = await fetch(endpoint, {
      method,
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json'
      },
      body: JSON.stringify(payload)
    });
    if (res.ok) {
      formStatus.style.color = 'var(--success)';
      formStatus.textContent = "Message sent ✔️";
      form.reset();
      return;
    } else {
      let info = '';
      try {
        const json = await res.json();
        info = json.error || json.message || JSON.stringify(json);
      } catch (e) { info = res.statusText || `HTTP ${res.status}`; }
      console.warn('JSON POST rejected:', info);
    }
  } catch (jsonErr) {
    console.warn('JSON POST failed (network/CORS):', jsonErr);
  }

  try {
    const formData = new FormData();
    formData.append('name', name);
    formData.append('message', message);
    const res2 = await fetch(endpoint, {
      method,
      body: formData,
      headers: { 'Accept': 'application/json' }
    });
    if (res2.ok) {
      formStatus.style.color = 'var(--success)';
      formStatus.textContent = "Message sent ✔️";
      form.reset();
      return;
    } else {
      let info2 = '';
      try {
        const json = await res2.json();
        info2 = json.error || json.message || JSON.stringify(json);
      } catch (e) { info2 = res2.statusText || `HTTP ${res2.status}`; }
      console.warn('FormData POST rejected:', info2);
      formStatus.style.color = 'var(--error)';
      formStatus.textContent = `Server error: ${info2}`;
      return;
    }
  } catch (formDataErr) {
    console.warn('FormData POST failed:', formDataErr);
  }

  formStatus.style.color = 'var(--error)';
  formStatus.innerHTML = 'Could not send via the server. <a href="#" id="mailto-fallback">Send by email instead</a>';
  const mailtoLink = document.getElementById('mailto-fallback');
  if (mailtoLink) {
    const subject = encodeURIComponent('Message from synt website');
    const body = encodeURIComponent(`Name: ${name}\n\nMessage:\n${message}`);
    mailtoLink.href = `mailto:hello@example.com?subject=${subject}&body=${body}`;
    mailtoLink.addEventListener('click', () => {
      formStatus.textContent = 'Opening email client...';
    }, { once: true });
  }
}
form.addEventListener('submit', submitFormRobust);

/* ======================
   goHome: hide sections and restore stage
   ====================== */
function goHome() {
  sections.forEach(s => {
    s.style.display = 'none';
    s.setAttribute('aria-hidden', 'true');
  });
  stage.style.opacity = 1;
  document.querySelector('main').setAttribute('aria-hidden', 'false');
  if (logo && typeof logo.focus === 'function') logo.focus();
}
</script>
</body>
</html>
